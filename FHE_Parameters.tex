\documentclass[a4paper,10pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{multirow}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{comment}
%opening
\title{CKKS Error Estimation and Parameter}
\author{}
\date{}

\begin{document}

\maketitle

\paragraph{CKKS Error Estimation}
The number of error bits in fresh ciphertext $c_1$ encrypting message $m_1$ using error distribution $N(0,\sigma^2 I_N)$ and secret distribution $\{-1,0,1\}$ is given by (Using Central Limit Theory (CLT))

\begin{equation}
 \epsilon_1 = \frac{1}{2}\log N(\rho_{fresh}^2+\frac{1}{12}) + log H_c (\alpha,N)
\end{equation}
where

\begin{align*}
    \rho^2_{fresh}&=(\frac{4}{3}N+1)\sigma^2 \\
    H_c (\alpha,N)&=(-\log (1-(1-\alpha)^\frac{2}{N})^\frac{1}{2}
\end{align*}

$\alpha$ =failure probability or error tolerance

Similarly, ciphertext $c_2$ encrypting message $m_2$ using the error distribution $N(0,\sigma'^2 I_N)$ and same secret distribution can be written as
\begin{equation}
 \epsilon_2 = \frac{1}{2}\log N(\rho_{fresh}'^2+\frac{1}{12}) + log H_c (\alpha,N)
\end{equation}
where
\begin{align*}
    \rho'^2_{fresh}&=(\frac{4}{3}N+1)\sigma'^2 \\
\end{align*}

\paragraph{Addition} Adding these two ciphertext results into ciphertext with error bits
\begin{align}
  \epsilon_1+\epsilon_2 &= \frac{1}{2}\log N(\rho_{fresh}''^2+\frac{1}{6}) + log 2H_c (\alpha,N)
\end{align}
where
\begin{align*}
    \rho''^2_{fresh}&=(\frac{4}{3}N+1)(\sigma^2+\sigma'^2) \\
\end{align*}

\paragraph{Multiplication by constant}: Multiplying the ciphertext with a constant results in a ciphertext with error as
\begin{align}
    err &= ||\lambda||^2_2(\frac{4}{3}N+1)\sigma^2
\end{align}

\paragraph{Multiplication}: Multiplication of two ciphertext results into ciphertext with error of the following form
\begin{align}
    B_{final\ error} &= \Delta^{-1}(B_{mult}+B_{ks})+B_{round}
\end{align}

\begin{align*}
B_{mult} &= N(0,N\rho_{fresh}^2\rho_{fresh}'^2I_N) \\
  B_{ks} &= N(0,\eta_{ks}^2I_N) \\
  B_{round} &= N(0,\eta_{round}^2 I_N)
\end{align*}
where

\begin{align*}
\rho_{fresh}^2 &=(\frac{4}{3}N+1)\sigma^2 \\
\rho_{fresh}'^2 &=(\frac{4}{3}N+1)\sigma'^2 \\
\eta_{ks}^2     &=\frac{1}{12}p^{-2}q^2_{l}N\sigma^2+1_{p \nmid q_l}(\frac{N}{18}+\frac{1}{12}) \\
                &=\frac{1}{12} N\sigma^2 \hspace{3em}[usually\ \ p^{-2}q^2_{l}\approx 1]\\
\eta^2_{round}  &= \frac{N}{18} + \frac{1}{12}\\
\end{align*}

The final error of multiplication of two ciphertext can be written down as
\begin{align}
    B_{final\ error} &= \Delta^{-1}(N(0,N\rho_{fresh}^2\rho_{fresh}'^2I_N)+ N(0,\eta_{ks}^2I_N))+N(0,\eta_{round}^2 I_N) \nonumber \\
                     &= N(0,\Delta^{-2}N(\rho_{fresh}^2\rho_{fresh}'^2+\frac{1}{12}\sigma^2)I_N) + N(0,(\frac{N}{18}+\frac{1}{12})I_N) \nonumber \\
                     &= N \biggl(0,\Bigl(\Delta^{-2}N(\rho_{fresh}^2\rho_{fresh}'^2+\frac{1}{12}\sigma^2)+\frac{N}{18}+\frac{1}{12}\Bigr)I_N\biggl) \nonumber \\
                     &=N(0,\rho_{mult\ error}^2I_N)
\end{align}
where
\begin{align*}
\rho_{mult\ error}^2 &= \Delta^{-2}N(\rho_{fresh}^2\rho_{fresh}'^2+\frac{1}{12}\sigma^2)+\frac{N}{18}+\frac{1}{12}  \\
\end{align*}








\newpage
\paragraph{CKKS parameter} Here is the list of parameter values suggested by the homomorphic encryption standar to retain differnt security levels.




\begin{center}
\begin{table}[h]
\begin{tabular}{|c|c|c|c|c|c|}
\hline
N  &  security level & $\log q$ &  uSVP & dec & dual  \\
\hline
\multirow{3}{4em}{1024} & 128 & 25 & 132.6 & 165.5 & 142.3 \\
& 192 & 17 & 199.9 & 284.1 & 222.2 \\
& 256 & 13 & 262.6 & 423.1 & 296.6 \\
\hline
\multirow{3}{4em}{2048} & 128 & 51 & 128.6 & 144.3 & 133.4 	\\
& 192 & 35 & 193.5 & 231.9 & 205.2 \\
& 256 & 27 & 257.1 & 327.8 & 274.4 \\
\hline
\multirow{3}{4em}{4096} & 128 & 101 & 129.6 & 137.4 & 131.5  \\
& 192 & 70 & 193.7 & 213.6 & 198.8 \\
& 256 & 54 & 259.7 & 295.2 & 270.6 \\
\hline
\multirow{3}{4em}{8192} & 128 & 202 & 129.8 & 130.7 & 128.0\\
& 192 & 141 & 192.9 & 202.5 & 196.1\\
& 256 & 109 & 258.3 & 276.6 & 263.1\\
\hline
\multirow{3}{4em}{16384} & 128 & 411 & 128.2 & 129.5 & 129.0\\
& 192 & 284 & 192.0 & 196.8 & 193.7\\
& 256 & 220 & 257.2 & 265.8 & 260.7\\
\hline
\multirow{3}{4em}{32768} & 128 & 827 & 128.1 & 128.7 & 128.4\\
& 192 & 571 & 192.0 & 194.1 & 193.1\\
& 256 & 443 & 256.1 & 260.4 & 260.4\\
\hline

\end{tabular}
\caption{The differnt parameter values shown in the table means following $N$ is the ring dimension, security level is the bit security provided by the chosen parameter valuse equivalent to that of AES, $\log q$ is the number of bits in the modulus $q$. $uSVP$ represents the bit security against attack using unique shortest vector problem, $dec$ represents the bit security against decoding attack and $dual$ represnts the bit security against dual attack.}
\end{table}
\end{center}









\begin{comment}
CKKS Parameters
\newline
This file contains the parameter values used for homomorphic encryption scheme CKKS. Following parameters values are used in Openfhe library for 128-bit security. Error values are sampled from gaussion distribution with standard deviation $3.2$ and secret key is sampled from discrete uniform ternary distribution with variance as $\frac{2}{3}=.6666$.


    batchSize = 8;
    MultiplicativeDepth=6;
    ScalingModSize=90;
    RingDimension=65536
    RingModulus=645

    batchSize = 8;
    MultiplicativeDepth=10;
    ScalingModSize=90;
    RingDimension=65536
    RingModulus=1006

    batchSize = 8;
    MultiplicativeDepth=6;
    ScalingModSize=80;
    RingDimension=32768
    RingModulus=585


    batchSize = 8;
    MultiplicativeDepth=6;
    ScalingModSize=70
    RingDimension=32768
    RingModulus=524

    batchSize = 8;
    MultiplicativeDepth=6;
    ScalingModSize=60;
    RingDimension=32768
    RingModulus=465

    batchSize = 8;
    MultiplicativeDepth=6;
    ScalingModSize=50;
    RingDimension=32768
    RingModulus=404


    batchSize = 8;
    MultiplicativeDepth=6;
    ScalingModSize=40
    RingDimension=32768
    RingModulus=344

    batchSize = 8;
    MultiplicativeDepth=6;
    ScalingModSize=30;
    RingDimension=16384
    RingModulus=284


    Apart form the above mentioned parameters homomorphic encryption standar suggests following paramters as secure parameters.
 The same parametes have been used in the paper "On the precision loss in approximate homomorphic encryption" as mentioned below.

(Dimension,modulus): (log(N),log(q)) as

                            (13,109) , (14,220) , (15,443)


 Error Distribution: Gaussion with std. deviation 3.2;
 Secret Distribution: uniform ternary distribution viz. (-1,0,1) with variance $\frac{1}{3}=.33333$;
 Delta=$2^{40}$.

 Here is the list of parameter values for varing security levels. Secret and error distribution remains same as that of mentioned above.
(Here number corresponding to SVP, dec and dual means bit security provided by the parameter values when attacked using unique svp ,decoding and dual attack)

\end{comment}




\end{document}






